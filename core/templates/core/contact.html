{% extends 'core/base.html' %}
{% load static %}

{% block title %}Contacto - Nicolás Lintz{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center py-16 px-6 bg-gradient-to-b from-[#100034] to-[#1a013a]">
    <div class="max-w-lg w-full bg-gradient-to-b from-[#2c0b5f]/80 to-[#3b0a78]/80 backdrop-blur-lg rounded-2xl shadow-purple-glow p-10 animate-fade-in scale-95 hover:scale-100 transition-transform duration-500">

        <h1 class="text-4xl font-extrabold text-white mb-6 text-center animate-fade-in-down">Contáctame 💬</h1>
        <p class="text-gray-300 mb-8 text-center animate-fade-in-delay">
            Si tienes alguna pregunta, propuesta o simplemente quieres saludar, ¡escríbeme!
        </p>

        <form id="contactForm" method="POST" class="space-y-6 animate-fade-in-up">
            {% csrf_token %}

            <div>
                {{ form.name }}
            </div>
            <div>
                {{ form.email }}
            </div>
            <div>
                {{ form.message }}
            </div>

            <div class="flex justify-center">
                <button 
                    id="submitBtn"
                    type="submit"
                    class="bg-custom-purple text-white font-semibold px-8 py-3 rounded-full shadow-lg hover:shadow-purple-600/50 hover:scale-105 transition-all duration-500 animate-pulse"
                >
                    Enviar Mensaje
                </button>
            </div>
        </form>

        <div id="toastContainer" class="fixed bottom-6 right-6 z-[100] space-y-3"></div>
    </div>
</div>

<style>
@keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-20px); } 100% { opacity: 1; transform: translateY(0); } }
@keyframes fade-in-up { 0% { opacity: 0; transform: translateY(20px); } 100% { opacity: 1; transform: translateY(0); } }
@keyframes fade-in { 0% { opacity: 0; } 100% { opacity: 1; } }
@keyframes slide-in-right { from { opacity: 0; transform: translateX(100%); } to { opacity: 1; transform: translateX(0); } }
@keyframes slide-out-right { from { opacity: 1; transform: translateX(0); } to { opacity: 0; transform: translateX(100%); } }
@keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

.animate-fade-in-down { animation: fade-in-down 0.8s ease-out forwards; }
.animate-fade-in-up { animation: fade-in-up 0.8s ease-out forwards; }
.animate-fade-in { animation: fade-in 0.9s ease-out forwards; }
.animate-pulse { animation: pulse 2s infinite; }

.toast-enter { animation: slide-in-right 0.5s ease-out forwards; }
.toast-exit { animation: slide-out-right 0.5s ease-in forwards; }

.shadow-purple-glow { box-shadow: 0 10px 25px rgba(99, 102, 241, 0.5); }
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('contactForm');
    const btn = document.getElementById('submitBtn');
    const toastContainer = document.getElementById('toastContainer');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        btn.disabled = true;
        btn.innerHTML = 'Enviando...';

        const formData = new FormData(form);

        try {
            const response = await fetch("{% url 'contact' %}", {
                method: "POST",
                headers: { 'X-Requested-With': 'XMLHttpRequest' },
                body: formData
            });
            const result = await response.json();

            if (result.status === 'ok') {
                showToast('✅ ' + result.message, 'success');
                form.reset();
            } else {
                showToast('⚠️ ' + result.message, 'error');
            }
        } catch (error) {
            showToast('❌ Hubo un error al enviar el mensaje.', 'error');
        }

        btn.disabled = false;
        btn.innerHTML = "Enviar Mensaje";
    });

    function showToast(message, type) {
        const toast = document.createElement('div');
        toast.className = `toast-enter text-white px-5 py-3 rounded-lg shadow-lg font-semibold transition-all duration-300 
            ${type === 'success' ? 'bg-green-600' : 'bg-red-600'}`;
        toast.textContent = message;
        toastContainer.appendChild(toast);

        setTimeout(() => {
            toast.classList.replace('toast-enter', 'toast-exit');
            setTimeout(() => toast.remove(), 500);
        }, 4000);
    }
});
</script>
{% endblock %}